# =============================================================================
# Database Configuration
# =============================================================================
DATABASE_URL=postgres://linkko:linkko@localhost:5432/linkko?sslmode=disable

# =============================================================================
# Redis Configuration (for rate limiting)
# =============================================================================
# Local: redis://localhost:6379
# Upstash: rediss://default:password@host:port
REDIS_URL=redis://localhost:6379

# =============================================================================
# JWT Configuration - HS256 (Shared Secret)
# =============================================================================
# Used by crm-web frontend for user authentication
# MUST be Base64-encoded for security (decode to minimum 32 bytes = 256 bits)
# Generate Base64-encoded secret with: openssl rand -base64 32
# Example: eW91ci1zdXBlci1zZWNyZXQta2V5LW1pbi0zMi1jaGFycy1wbGVhc2UtY2hhbmdlLXRoaXMtbm93
JWT_HS256_SECRET=eW91ci1zdXBlci1zZWNyZXQta2V5LW1pbi0zMi1jaGFycy1wbGVhc2UtY2hhbmdlLXRoaXMtbm93

# JWT Allowed Issuers - CSV list of trusted JWT issuers
# Multiple issuers supported (e.g., "linkko-crm-web,linkko-admin-portal")
# Parse is robust: ignores whitespace and empty entries
# Default: linkko-crm-web (frontend application)
JWT_ALLOWED_ISSUERS=linkko-crm-web

# JWT Audience - identifies who the token is intended for
# REQUIRED: Must match exactly the "aud" claim in JWT tokens
# CRM frontend should emit tokens with aud="linkko-api-gateway"
# Validation is case-sensitive and requires exact match
# Default: linkko-api-gateway (this API)
JWT_AUDIENCE=linkko-api-gateway

# JWT Clock Skew - tolerance for token expiration in seconds
# Default: 60 (allows 1 minute clock difference between servers)
JWT_CLOCK_SKEW_SECONDS=60

# =============================================================================
# S2S (Service-to-Service) Authentication Tokens
# =============================================================================
# Pre-shared tokens for trusted backend services
# Generate with: openssl rand -hex 32

# Token for CRM backend service
S2S_TOKEN_CRM=your-crm-service-token-here-min-32-chars-change-this

# Token for MCP (Model Context Protocol) server
S2S_TOKEN_MCP=your-mcp-service-token-here-min-32-chars-change-this

# =============================================================================
# Legacy JWT Configuration (DEPRECATED)
# =============================================================================
# These variables are deprecated and maintained only for backward compatibility
# Migration guide:
#   - JWT_SECRET_CRM_V1 → Use JWT_HS256_SECRET (Base64-encoded)
#   - JWT_PUBLIC_KEY_MCP_V1 → Use S2S_TOKEN_MCP for service auth
#   - JWT_ALLOWED_ISSUERS → Use JWT_ISSUER (single issuer)
#
# JWT_SECRET_CRM_V1=your-old-secret-here
# JWT_PUBLIC_KEY_MCP_V1=-----BEGIN PUBLIC KEY-----\nMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA...\n-----END PUBLIC KEY-----
# JWT_ALLOWED_ISSUERS=linkko-crm-web,linkko-mcp-server

# =============================================================================
# OpenTelemetry Configuration
# =============================================================================
OTEL_EXPORTER_OTLP_ENDPOINT=localhost:4317
OTEL_SERVICE_NAME=linkko-api-go
OTEL_SAMPLING_RATIO=0.1

# =============================================================================
# Server Configuration
# =============================================================================
PORT=8080

# Rate Limiting (requests per minute per workspace)
# =============================================================================
RATE_LIMIT_PER_WORKSPACE_PER_MIN=100

# =============================================================================
# Environment Configuration
# =============================================================================
# Options: dev, staging, prod
APP_ENV=prod
